{"ast":null,"code":"import{createContext,useEffect,useState}from\"react\";import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";export const StoreContext=/*#__PURE__*/createContext(null);const StoreContextProvider=props=>{const[cartitem,setCarttitem]=useState({});const[token,setToken]=useState(\"\");const[food_list,setFoodlist]=useState([]);const addtocart=itemId=>{if(!cartitem[itemId]){setCarttitem(prev=>({...prev,[itemId]:1}));}else{setCarttitem(prev=>({...prev,[itemId]:prev[itemId]+1}));}if(token){axios.post(\"http://localhost:5000/add\",{itemId,userId:token},{headers:{token}}).catch(error=>console.error('Error adding to cart:',error));}};const remove=itemId=>{if(cartitem[itemId]>1){setCarttitem(prev=>({...prev,[itemId]:prev[itemId]-1}));}else{const{[itemId]:_,...rest}=cartitem;setCarttitem(rest);}if(token){axios.post(\"http://localhost:5000/remove\",{itemId,userId:token},{headers:{token}}).catch(error=>console.error('Error removing from cart:',error));}};const getTotal=()=>{let Total=0;for(const item in cartitem){if(cartitem[item]>0){let itemInfo=food_list.find(product=>product._id===item);if(itemInfo){Total+=itemInfo.price*cartitem[item];}}}return Total;};const url=\"http://localhost:5000\";const contextvalue={food_list,cartitem,setCarttitem,addtocart,remove,getTotal,token,setToken,url};const fetchfoodlist=async()=>{try{const res=await axios.get(\"http://localhost:5000/list\");setFoodlist(res.data.data);}catch(error){console.error('Error fetching food list:',error);}};const loadcartdata=async token=>{try{const res=await axios.post(\"http://localhost:5000/get\",{userId:token},{headers:{token}});setCarttitem(res.data.cartdata);}catch(error){console.error('Error loading cart data:',error);}};useEffect(()=>{async function loaddata(){await fetchfoodlist();const savedToken=localStorage.getItem(\"token\");if(savedToken){setToken(savedToken);await loadcartdata(savedToken);}}loaddata();},[]);return/*#__PURE__*/_jsx(StoreContext.Provider,{value:contextvalue,children:props.children});};export default StoreContextProvider;","map":{"version":3,"names":["createContext","useEffect","useState","axios","jsx","_jsx","StoreContext","StoreContextProvider","props","cartitem","setCarttitem","token","setToken","food_list","setFoodlist","addtocart","itemId","prev","post","userId","headers","catch","error","console","remove","_","rest","getTotal","Total","item","itemInfo","find","product","_id","price","url","contextvalue","fetchfoodlist","res","get","data","loadcartdata","cartdata","loaddata","savedToken","localStorage","getItem","Provider","value","children"],"sources":["C:/Users/kishore/Desktop/ZWIGGY/frontend/src/Menu/CONTEXT/StoreContext.js"],"sourcesContent":["import { createContext, useEffect, useState } from \"react\";\r\nimport axios from 'axios';\r\n\r\nexport const StoreContext = createContext(null);\r\n\r\nconst StoreContextProvider = (props) => {\r\n  const [cartitem, setCarttitem] = useState({});\r\n  const [token, setToken] = useState(\"\");\r\n  const [food_list, setFoodlist] = useState([]);\r\n  \r\n  const addtocart = (itemId) => {\r\n    if (!cartitem[itemId]) {\r\n      setCarttitem((prev) => ({ ...prev, [itemId]: 1 }));\r\n    } else {\r\n      setCarttitem((prev) => ({ ...prev, [itemId]: prev[itemId] + 1 }));\r\n    }\r\n    if (token) {\r\n      axios.post(\"http://localhost:5000/add\", { itemId, userId: token }, { headers: { token } })\r\n        .catch(error => console.error('Error adding to cart:', error));\r\n    }\r\n  };\r\n\r\n  const remove = (itemId) => {\r\n    if (cartitem[itemId] > 1) {\r\n      setCarttitem((prev) => ({ ...prev, [itemId]: prev[itemId] - 1 }));\r\n    } else {\r\n      const { [itemId]: _, ...rest } = cartitem;\r\n      setCarttitem(rest);\r\n    }\r\n    if (token) {\r\n      axios.post(\"http://localhost:5000/remove\", { itemId, userId: token }, { headers: { token } })\r\n        .catch(error => console.error('Error removing from cart:', error));\r\n    }\r\n  };\r\n\r\n  const getTotal = () => {\r\n    let Total = 0;\r\n    for (const item in cartitem) {\r\n      if (cartitem[item] > 0) {\r\n        let itemInfo = food_list.find((product) => product._id === item);\r\n        if (itemInfo) {\r\n          Total += itemInfo.price * cartitem[item];\r\n        }\r\n      }\r\n    }\r\n    return Total;\r\n  };\r\n\r\n  const url = \"http://localhost:5000\";\r\n  const contextvalue = {\r\n    food_list,\r\n    cartitem, setCarttitem, addtocart, remove, getTotal, token, setToken, url\r\n  };\r\n\r\n  const fetchfoodlist = async () => {\r\n    try {\r\n      const res = await axios.get(\"http://localhost:5000/list\");\r\n      setFoodlist(res.data.data);\r\n    } catch (error) {\r\n      console.error('Error fetching food list:', error);\r\n    }\r\n  };\r\n\r\n  const loadcartdata = async (token) => {\r\n    try {\r\n      const res = await axios.post(\"http://localhost:5000/get\", { userId: token }, { headers: { token } });\r\n      setCarttitem(res.data.cartdata);\r\n    } catch (error) {\r\n      console.error('Error loading cart data:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    async function loaddata() {\r\n      await fetchfoodlist();\r\n      const savedToken = localStorage.getItem(\"token\");\r\n      if (savedToken) {\r\n        setToken(savedToken);\r\n        await loadcartdata(savedToken);\r\n      }\r\n    }\r\n    loaddata();\r\n  }, []);\r\n\r\n  return (\r\n    <StoreContext.Provider value={contextvalue}>\r\n      {props.children}\r\n    </StoreContext.Provider>\r\n  );\r\n};\r\n\r\nexport default StoreContextProvider;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}